# -*- coding: utf-8 -*-
"""JUNK_notebook.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1LNsUzsNoRJCO0QAy5bH34pKlvswbysct
"""

import numpy as np 
import pandas as pd

import os
import sys
import matplotlib.pyplot as plt 
import re
import datetime

import tensorflow as tf 
from tensorflow import keras
import datetime
import time
"""this dataset was released in 2018, therefore age calculations will be performed according to 2018"""
from tqdm import *
import re, string
from google.colab import drive 
drive.mount('/content/drive')

#### In this dataset following columns will not be included in the analysis title_japanes, image_url, background, relaed, title_english, title_synonims

users_cleand_cols = ['anime_id', 'title', 
                            'type', 'source', 'episodes', 'status',
                            'airing', 'aired_string', 'aired', 'duration', 'rating', 'score',
                            'scored_by', 'rank', 'popularity', 'members', 'favorites',
                            'premiered', 'broadcast', 'producer', 'licensor', 'studio',
                            'genre', 'opening_theme', 'ending_theme', 'duration_min',
                            'aired_from_year']

anime_cleaned = pd.read_csv('drive/MyDrive/Colab Notebooks/datasets/anime/anime_cleaned.csv'
                            ,usecols= users_cleand_cols
                            # ,nrows = 100
                           ).dropna()
anime_cleaned = anime_cleaned.reset_index(drop= True)

anime_cleaned.head(3)



''.join(filter(lambda character:ord(character) < 0x3000,anime_cleaned['opening_theme'][10]))
genre_num = []
for i in anime_cleaned['genre']:
  genre_num.append(len(str(i).split(',')))

o_theme = []
for i in anime_cleaned['opening_theme']:
  y = ''.join(filter(lambda character:ord(character) < 0x3000,(i)))
  y= re.sub("\(|\)","",y)
  x =  re.findall(r'["][\w\s]+["]',y)
  o_theme.append(x)

e_theme = []
for i in anime_cleaned['ending_theme']:
  y = ''.join(filter(lambda character:ord(character) < 0x3000,(i)))
  y= re.sub("\(|\)","",y)
  x =  re.findall(r'["][\w\s]+["]',i)
  e_theme.append(x)

anime_cleaned['genre_num'] = genre_num ### number of different genres for related anime data 
anime_cleaned['o_theme'] = o_theme  #### There are some entries which contain more than one opening and ending songs, I am aware of that , I will stick to one for ending and one for opening theme 
anime_cleaned['e_theme'] = e_theme



anime_cleaned.head(3)

anime_cleaned.to_csv('drive/MyDrive/Colab Notebooks/datasets/anime/anime_cleaned_2.csv')











